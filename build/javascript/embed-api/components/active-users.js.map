{"version":3,"sources":["webpack:///active-users.js","webpack:///webpack/bootstrap 717bd62df027c4c38d49","webpack:///./src/javascript/embed-api/components/active-users.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","gapi","analytics","ready","createComponent","initialize","this","activeUsers","auth","once","handleSignOut_","bind","execute","polling_","stop","render_","isAuthorized","pollActiveUsers_","clearTimeout","timeout_","emit","opts","get","container","document","getElementById","innerHTML","template","querySelector","options","pollingInterval","isNaN","Error","client","data","realtime","ids","metrics","then","response","result","newValue","totalResults","rows","oldValue","onChange_","setTimeout","delta","valueContainer","handleSignIn_"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,GAGAV,EAAA,KDMM,SAASI,EAAQD,GAEtB,YE5BDQ,MAAKC,UAAUC,MAAM,WAEnBF,KAAKC,UAAUE,gBAAgB,eAE7BC,WAAY,WACVC,KAAKC,YAAc,EACnBN,KAAKC,UAAUM,KAAKC,KAAK,UAAWH,KAAKI,eAAeC,KAAKL,QAG/DM,QAAS,WAEHN,KAAKO,UACPP,KAAKQ,OAGPR,KAAKS,UAGDd,KAAKC,UAAUM,KAAKQ,eACtBV,KAAKW,mBAGLhB,KAAKC,UAAUM,KAAKC,KAAK,SAAUH,KAAKW,iBAAiBN,KAAKL,QAIlEQ,KAAM,WACJI,aAAaZ,KAAKa,UAClBb,KAAKO,UAAW,EAChBP,KAAKc,KAAK,QAASb,YAAaD,KAAKC,eAGvCQ,QAAS,WACP,GAAIM,GAAOf,KAAKgB,KAGhBhB,MAAKiB,UAAqC,gBAAlBF,GAAKE,UACzBC,SAASC,eAAeJ,EAAKE,WAAaF,EAAKE,UAEnDjB,KAAKiB,UAAUG,UAAYL,EAAKM,UAAYrB,KAAKqB,SACjDrB,KAAKiB,UAAUK,cAAc,KAAKF,UAAYpB,KAAKC,aAGrDU,iBAAkB,WAChB,GAAIY,GAAUvB,KAAKgB,MACfQ,EAAmD,KAAhCD,EAAQC,iBAAmB,EAElD,IAAIC,MAAMD,IAAoBA,EAAkB,IAC9C,KAAM,IAAIE,OAAM,uCAGlB1B,MAAKO,UAAW,EAChBZ,KAAKgC,OAAO/B,UAAUgC,KAAKC,SACtBb,KAAKc,IAAKP,EAAQO,IAAKC,QAAS,mBAChCC,KAAK,SAASC,GAEjB,GAAIC,GAASD,EAASC,OAClBC,EAAWD,EAAOE,cAAgBF,EAAOG,KAAK,GAAG,GAAK,EACtDC,EAAWtC,KAAKC,WAEpBD,MAAKc,KAAK,WAAYb,YAAaD,KAAKC,cAEpCkC,GAAYG,IACdtC,KAAKC,YAAckC,EACnBnC,KAAKuC,UAAUJ,EAAWG,IAGP,GAAjBtC,KAAKO,WACPP,KAAKa,SAAW2B,WAAWxC,KAAKW,iBAAiBN,KAAKL,MAClDwB,KAENnB,KAAKL,QAGTuC,UAAW,SAASE,GAClB,GAAIC,GAAiB1C,KAAKiB,UAAUK,cAAc,IAC9CoB,KAAgBA,EAAetB,UAAYpB,KAAKC,aAEpDD,KAAKc,KAAK,UAAWb,YAAaD,KAAKC,YAAawC,MAAOA,IACvDA,EAAQ,EACVzC,KAAKc,KAAK,YAAab,YAAaD,KAAKC,YAAawC,MAAOA,IAG7DzC,KAAKc,KAAK,YAAab,YAAaD,KAAKC,YAAawC,MAAOA,KAIjErC,eAAgB,WACdJ,KAAKQ,OACLb,KAAKC,UAAUM,KAAKC,KAAK,SAAUH,KAAK2C,cAActC,KAAKL,QAG7D2C,cAAe,WACb3C,KAAKW,mBACLhB,KAAKC,UAAUM,KAAKC,KAAK,UAAWH,KAAKI,eAAeC,KAAKL,QAG/DqB,SACE","file":"active-users.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\t// Copyright 2015 Google Inc. All rights reserved.\n\t//\n\t// Licensed under the Apache License, Version 2.0 (the \"License\");\n\t// you may not use this file except in compliance with the License.\n\t// You may obtain a copy of the License at\n\t//\n\t//     http://www.apache.org/licenses/LICENSE-2.0\n\t//\n\t// Unless required by applicable law or agreed to in writing, software\n\t// distributed under the License is distributed on an \"AS IS\" BASIS,\n\t// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\t// See the License for the specific language governing permissions and\n\t// limitations under the License.\n\t\n\t\n\t/* global gapi */\n\t\n\tgapi.analytics.ready(function () {\n\t\n\t  gapi.analytics.createComponent('ActiveUsers', {\n\t\n\t    initialize: function initialize() {\n\t      this.activeUsers = 0;\n\t      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n\t    },\n\t\n\t    execute: function execute() {\n\t      // Stop any polling currently going on.\n\t      if (this.polling_) {\n\t        this.stop();\n\t      }\n\t\n\t      this.render_();\n\t\n\t      // Wait until the user is authorized.\n\t      if (gapi.analytics.auth.isAuthorized()) {\n\t        this.pollActiveUsers_();\n\t      } else {\n\t        gapi.analytics.auth.once('signIn', this.pollActiveUsers_.bind(this));\n\t      }\n\t    },\n\t\n\t    stop: function stop() {\n\t      clearTimeout(this.timeout_);\n\t      this.polling_ = false;\n\t      this.emit('stop', { activeUsers: this.activeUsers });\n\t    },\n\t\n\t    render_: function render_() {\n\t      var opts = this.get();\n\t\n\t      // Render the component inside the container.\n\t      this.container = typeof opts.container == 'string' ? document.getElementById(opts.container) : opts.container;\n\t\n\t      this.container.innerHTML = opts.template || this.template;\n\t      this.container.querySelector('b').innerHTML = this.activeUsers;\n\t    },\n\t\n\t    pollActiveUsers_: function pollActiveUsers_() {\n\t      var options = this.get();\n\t      var pollingInterval = (options.pollingInterval || 5) * 1000;\n\t\n\t      if (isNaN(pollingInterval) || pollingInterval < 5000) {\n\t        throw new Error('Frequency must be 5 seconds or more.');\n\t      }\n\t\n\t      this.polling_ = true;\n\t      gapi.client.analytics.data.realtime.get({ ids: options.ids, metrics: 'rt:activeUsers' }).then(function (response) {\n\t\n\t        var result = response.result;\n\t        var newValue = result.totalResults ? +result.rows[0][0] : 0;\n\t        var oldValue = this.activeUsers;\n\t\n\t        this.emit('success', { activeUsers: this.activeUsers });\n\t\n\t        if (newValue != oldValue) {\n\t          this.activeUsers = newValue;\n\t          this.onChange_(newValue - oldValue);\n\t        }\n\t\n\t        if (this.polling_ == true) {\n\t          this.timeout_ = setTimeout(this.pollActiveUsers_.bind(this), pollingInterval);\n\t        }\n\t      }.bind(this));\n\t    },\n\t\n\t    onChange_: function onChange_(delta) {\n\t      var valueContainer = this.container.querySelector('b');\n\t      if (valueContainer) valueContainer.innerHTML = this.activeUsers;\n\t\n\t      this.emit('change', { activeUsers: this.activeUsers, delta: delta });\n\t      if (delta > 0) {\n\t        this.emit('increase', { activeUsers: this.activeUsers, delta: delta });\n\t      } else {\n\t        this.emit('decrease', { activeUsers: this.activeUsers, delta: delta });\n\t      }\n\t    },\n\t\n\t    handleSignOut_: function handleSignOut_() {\n\t      this.stop();\n\t      gapi.analytics.auth.once('signIn', this.handleSignIn_.bind(this));\n\t    },\n\t\n\t    handleSignIn_: function handleSignIn_() {\n\t      this.pollActiveUsers_();\n\t      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n\t    },\n\t\n\t    template: '<div class=\"ActiveUsers\">' + 'Active Users: <b class=\"ActiveUsers-value\"></b>' + '</div>'\n\t\n\t  });\n\t});\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** active-users.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 717bd62df027c4c38d49\n **/","// Copyright 2015 Google Inc. All rights reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/* global gapi */\n\n\ngapi.analytics.ready(function() {\n\n  gapi.analytics.createComponent('ActiveUsers', {\n\n    initialize: function() {\n      this.activeUsers = 0;\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    execute: function() {\n      // Stop any polling currently going on.\n      if (this.polling_) {\n        this.stop();\n      }\n\n      this.render_();\n\n      // Wait until the user is authorized.\n      if (gapi.analytics.auth.isAuthorized()) {\n        this.pollActiveUsers_();\n      }\n      else {\n        gapi.analytics.auth.once('signIn', this.pollActiveUsers_.bind(this));\n      }\n    },\n\n    stop: function() {\n      clearTimeout(this.timeout_);\n      this.polling_ = false;\n      this.emit('stop', {activeUsers: this.activeUsers});\n    },\n\n    render_: function() {\n      let opts = this.get();\n\n      // Render the component inside the container.\n      this.container = typeof opts.container == 'string' ?\n          document.getElementById(opts.container) : opts.container;\n\n      this.container.innerHTML = opts.template || this.template;\n      this.container.querySelector('b').innerHTML = this.activeUsers;\n    },\n\n    pollActiveUsers_: function() {\n      let options = this.get();\n      let pollingInterval = (options.pollingInterval || 5) * 1000;\n\n      if (isNaN(pollingInterval) || pollingInterval < 5000) {\n        throw new Error('Frequency must be 5 seconds or more.');\n      }\n\n      this.polling_ = true;\n      gapi.client.analytics.data.realtime\n          .get({ids: options.ids, metrics: 'rt:activeUsers'})\n          .then(function(response) {\n\n        let result = response.result;\n        let newValue = result.totalResults ? +result.rows[0][0] : 0;\n        let oldValue = this.activeUsers;\n\n        this.emit('success', {activeUsers: this.activeUsers});\n\n        if (newValue != oldValue) {\n          this.activeUsers = newValue;\n          this.onChange_(newValue - oldValue);\n        }\n\n        if (this.polling_ == true) {\n          this.timeout_ = setTimeout(this.pollActiveUsers_.bind(this),\n              pollingInterval);\n        }\n      }.bind(this));\n    },\n\n    onChange_: function(delta) {\n      let valueContainer = this.container.querySelector('b');\n      if (valueContainer) valueContainer.innerHTML = this.activeUsers;\n\n      this.emit('change', {activeUsers: this.activeUsers, delta: delta});\n      if (delta > 0) {\n        this.emit('increase', {activeUsers: this.activeUsers, delta: delta});\n      }\n      else {\n        this.emit('decrease', {activeUsers: this.activeUsers, delta: delta});\n      }\n    },\n\n    handleSignOut_: function() {\n      this.stop();\n      gapi.analytics.auth.once('signIn', this.handleSignIn_.bind(this));\n    },\n\n    handleSignIn_: function() {\n      this.pollActiveUsers_();\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    template:\n      '<div class=\"ActiveUsers\">' +\n        'Active Users: <b class=\"ActiveUsers-value\"></b>' +\n      '</div>'\n\n  });\n\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/javascript/embed-api/components/active-users.js\n **/"],"sourceRoot":""}